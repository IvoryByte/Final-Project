---
title: "Yo, it's our project"
author: "Katie"
date: "5/2/2018"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(rvest)
```

```{r saving urls}
movies2018 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2018")
movies2017 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2017")
movies2016 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2016")
movies2015 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2015")
movies2014 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2014")
movies2013 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2013")
movies2012 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2012")
movies2011 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2011")
movies2010 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2010")
movies2009 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2009")
movies2009 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2009")
movies2008 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2008")
movies2007 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2007")
movies2006 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2006")
movies2005 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2005")
movies2004 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2004")
movies2003 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2003")
movies2002 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2002")
movies2001 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2001")
movies2000 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2000")
movies1999 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=1999")
movies1998 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=1998")
```

```{r url to nodes}
title2018 <- html_nodes(movies2018, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2018)")
score2018 <- html_nodes(movies2018, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+") %>%
  parse_double()
title2017 <- html_nodes(movies2017, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2017)")
score2017 <- html_nodes(movies2017, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2016 <- html_nodes(movies2016, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2016)")
score2016 <- html_nodes(movies2016, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2015 <- html_nodes(movies2015, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2015)")
score2015 <- html_nodes(movies2015, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2014 <- html_nodes(movies2014, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2014)")
score2014 <- html_nodes(movies2014, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2013 <- html_nodes(movies2013, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2013)")
score2013 <- html_nodes(movies2013, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2012 <- html_nodes(movies2012, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2012)")
score2012 <- html_nodes(movies2012, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2011 <- html_nodes(movies2011, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2011)")
score2011 <- html_nodes(movies2011, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2010 <- html_nodes(movies2010, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2010)")
score2010 <- html_nodes(movies2010, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2009 <- html_nodes(movies2009, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2009)")
score2009 <- html_nodes(movies2009, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2008 <- html_nodes(movies2008, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2008)")
score2008 <- html_nodes(movies2008, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2007 <- html_nodes(movies2007, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2007)")
score2007 <- html_nodes(movies2007, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2006 <- html_nodes(movies2006, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2006)")
score2006 <- html_nodes(movies2006, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2005 <- html_nodes(movies2005, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2005)")
score2005 <- html_nodes(movies2005, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2004 <- html_nodes(movies2004, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2004)")
score2004 <- html_nodes(movies2004, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2003 <- html_nodes(movies2003, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2003)")
score2003 <- html_nodes(movies2003, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2002 <- html_nodes(movies2002, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2002)")
score2002 <- html_nodes(movies2002, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2001 <- html_nodes(movies2001, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2001)")
score2001 <- html_nodes(movies2001, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2000 <- html_nodes(movies2000, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2000)")
score2000 <- html_nodes(movies2000, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title1999 <- html_nodes(movies1999, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(1999)")
score1999 <- html_nodes(movies1999, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title1998 <- html_nodes(movies1998, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(1998)")
score1998 <- html_nodes(movies1998, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
```

```{r strings to tibbles}
tib2018 <- tibble(title2018, score2018) %>%
  mutate(
    Year = str_extract(title2018, "[1,2,3,4,5,6,7,8,9,0]{4}")) %>%
  rename(
    Title = title2018,
    Score = score2018
  )
tib2017 <- tibble(title2017, score2017) %>%
  mutate(
    Year = str_extract(title2017, "[1,2,3,4,5,6,7,8,9,0]{4}")) %>%
  rename(
    Title = title2017,
    Score = score2017
  )
tib2016 <- tibble(title2016, score2016) %>%
  mutate(
    Year = str_extract(title2016, "[1,2,3,4,5,6,7,8,9,0]{4}")) %>%
  rename(
    Title = title2016,
    Score = score2016
  )
tib2015 <- tibble(title2015, score2015) %>%
  mutate(
    Year = str_extract(title2015, "[1,2,3,4,5,6,7,8,9,0]{4}")) %>%
  rename(
    Title = title2015,
    Score = score2015
  )
tib2014 <- tibble(title2014, score2014) %>%
  mutate(
    Year = str_extract(title2014, "[1,2,3,4,5,6,7,8,9,0]{4}")) %>%
  rename(
    Title = title2014,
    Score = score2014
  )
tib2013 <- tibble(title2013, score2013) %>%
  mutate(
    Year = str_extract(title2013, "[1,2,3,4,5,6,7,8,9,0]{4}")) %>%
  rename(
    Title = title2013,
    Score = score2013
  )
tib2012 <- tibble(title2012, score2012) %>%
  mutate(
    Year = str_extract(title2012, "[1,2,3,4,5,6,7,8,9,0]{4}")) %>%
  rename(
    Title = title2012,
    Score = score2012
  )
tib2011 <- tibble(title2011, score2011) %>%
  mutate(
    Year = str_extract(title2011, "[1,2,3,4,5,6,7,8,9,0]{4}")) %>%
  rename(
    Title = title2011,
    Score = score2011
  )
tib2010 <- tibble(title2010, score2010) %>%
  mutate(
    Year = str_extract(title2010, "[1,2,3,4,5,6,7,8,9,0]{4}")) %>%
  rename(
    Title = title2010,
    Score = score2010
  )
tib2009 <- tibble(title2009, score2009) %>%
  mutate(
    Year = str_extract(title2009, "[1,2,3,4,5,6,7,8,9,0]{4}")) %>%
  rename(
    Title = title2009,
    Score = score2009
  )
tib2008 <- tibble(title2008, score2008) %>%
  mutate(
    Year = str_extract(title2008, "[1,2,3,4,5,6,7,8,9,0]{4}")) %>%
  rename(
    Title = title2008,
    Score = score2008
  )
tib2007 <- tibble(title2007, score2007)%>%
  mutate(
    Year = str_extract(title2007, "[1,2,3,4,5,6,7,8,9,0]{4}")) %>%
  rename(
    Title = title2007,
    Score = score2007
  )
tib2006 <- tibble(title2006, score2006)%>%
  mutate(
    Year = str_extract(title2006, "[1,2,3,4,5,6,7,8,9,0]{4}"))%>%
  rename(
    Title = title2006,
    Score = score2006
  )
tib2005 <- tibble(title2005, score2005)%>%
  mutate(
    Year = str_extract(title2005, "[1,2,3,4,5,6,7,8,9,0]{4}"))%>%
  rename(
    Title = title2005,
    Score = score2005
  )
tib2004 <- tibble(title2004, score2004)%>%
  mutate(
    Year = str_extract(title2004, "[1,2,3,4,5,6,7,8,9,0]{4}"))%>%
  rename(
    Title = title2004,
    Score = score2004
  )
tib2003 <- tibble(title2003, score2003)%>%
  mutate(
    Year = str_extract(title2003, "[1,2,3,4,5,6,7,8,9,0]{4}"))%>%
  rename(
    Title = title2003,
    Score = score2003
  )
tib2002 <- tibble(title2002, score2002)%>%
  mutate(
    Year = str_extract(title2002, "[1,2,3,4,5,6,7,8,9,0]{4}"))%>%
  rename(
    Title = title2002,
    Score = score2002
  )
tib2001 <- tibble(title2001, score2001)%>%
  mutate(
    Year = str_extract(title2001, "[1,2,3,4,5,6,7,8,9,0]{4}"))%>%
  rename(
    Title = title2001,
    Score = score2001
  )
tib2000 <- tibble(title2000, score2000)%>%
  mutate(
    Year = str_extract(title2000, "[1,2,3,4,5,6,7,8,9,0]{4}"))%>%
  rename(
    Title = title2000,
    Score = score2000
  )
tib1999 <- tibble(title1999, score1999)%>%
  mutate(
    Year = str_extract(title1999, "[1,2,3,4,5,6,7,8,9,0]{4}"))%>%
  rename(
    Title = title1999,
    Score = score1999
  )
tib1998 <- tibble(title1998, score1998)%>%
  mutate(
    Year = str_extract(title1998, "[1,2,3,4,5,6,7,8,9,0]{4}"))%>%
  rename(
    Title = title1998,
    Score = score1998
  )

Popular_movies <- tib2018 %>%
  full_join(tib2017) %>%
  full_join(tib2016) %>%
  full_join(tib2015) %>%
  full_join(tib2014) %>%
  full_join(tib2013) %>%
  full_join(tib2012) %>%
  full_join(tib2011) %>%
  full_join(tib2010) %>%
  full_join(tib2009) %>%
  full_join(tib2008) %>%
  full_join(tib2007) %>%
  full_join(tib2006) %>%
  full_join(tib2005) %>%
  full_join(tib2004) %>%
  full_join(tib2003) %>%
  full_join(tib2002) %>%
  full_join(tib2001) %>%
  full_join(tib2000) %>%
  full_join(tib1999) %>%
  full_join(tib1998)
#tidy it, variables should be year, score, and title 

```

```{r Using the tibble}
Popular_movies %>%
  group_by(Year) %>%
  mutate(
    AverageScore = mean(Score)
  ) %>%
  ungroup() %>%
  ggplot(aes(x = Year)) +
  geom_point(aes(y = Score, label = Title)) +
  geom_line(aes(y = AverageScore)) +
  geom_text(data=subset(Popular_movies, score > 99 ), 
              check_overlap = TRUE, size = 2.5, nudge_y = 1)

```
