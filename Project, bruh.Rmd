---
title: "Yo, it's our project"
author: "Katie"
date: "5/2/2018"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(rvest)
```

```{r Top Movies by Year}
movies2018 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2018")
movies2017 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2017")
movies2016 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2016")
movies2015 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2015")
movies2014 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2014")
movies2013 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2013")
movies2012 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2012")
movies2011 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2011")
movies2010 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2010")
movies2009 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2009")
movies2009 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2009")
movies2008 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2008")
movies2007 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2007")
movies2006 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2006")
movies2005 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2005")
movies2004 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2004")
movies2003 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2003")
movies2002 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2002")
movies2001 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2001")
movies2000 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=2000")
movies1999 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=1999")
movies1998 <- read_html("https://www.rottentomatoes.com/top/bestofrt/?year=1998")


title2018 <- html_nodes(movies2018, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2018)")
score2018 <- html_nodes(movies2018, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+") %>%
  parse_double()
title2017 <- html_nodes(movies2017, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2017)")
score2017 <- html_nodes(movies2017, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2016 <- html_nodes(movies2016, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2016)")
score2016 <- html_nodes(movies2016, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2015 <- html_nodes(movies2015, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2015)")
score2015 <- html_nodes(movies2015, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2014 <- html_nodes(movies2014, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2014)")
score2014 <- html_nodes(movies2014, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2013 <- html_nodes(movies2013, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2013)")
score2013 <- html_nodes(movies2013, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2012 <- html_nodes(movies2012, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2012)")
score2012 <- html_nodes(movies2012, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2011 <- html_nodes(movies2011, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2011)")
score2011 <- html_nodes(movies2011, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2010 <- html_nodes(movies2010, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2010)")
score2010 <- html_nodes(movies2010, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2009 <- html_nodes(movies2009, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2009)")
score2009 <- html_nodes(movies2009, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2008 <- html_nodes(movies2008, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2008)")
score2008 <- html_nodes(movies2008, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2007 <- html_nodes(movies2007, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2007)")
score2007 <- html_nodes(movies2007, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2006 <- html_nodes(movies2006, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2006)")
score2006 <- html_nodes(movies2006, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2005 <- html_nodes(movies2005, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2005)")
score2005 <- html_nodes(movies2005, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2004 <- html_nodes(movies2004, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2004)")
score2004 <- html_nodes(movies2004, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2003 <- html_nodes(movies2003, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2003)")
score2003 <- html_nodes(movies2003, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2002 <- html_nodes(movies2002, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2002)")
score2002 <- html_nodes(movies2002, "#top_movies_main .tMeterScore")
title2001 <- html_nodes(movies2001, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2001)")
score2001 <- html_nodes(movies2001, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title2000 <- html_nodes(movies2000, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(2000)")
score2000 <- html_nodes(movies2000, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title1999 <- html_nodes(movies1999, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(1999)")
score1999 <- html_nodes(movies1999, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()
title1998 <- html_nodes(movies1998, "#top_movies_main .articleLink")%>%
  str_extract("  (.*)(1998)")
score1998 <- html_nodes(movies1998, "#top_movies_main .tMeterScore")%>%
  str_extract("[1,2,3,4,5,6,7,8,9,0]+")%>%
  parse_double()

tib2018 <- tibble(title2018, score2018) %>%
  separate(title2018, into = c("Title", "Year", sep = "\\(", convert = TRUE)

# *20

tib2007 <- tibble(title2007, score2007)
tib2006 <- tibble(title2006, score2006)
tib2005 <- tibble(title2005, score2005)
tib2004 <- tibble(title2004, score2004)
tib2003 <- tibble(title2003, score2003)
tib2002 <- tibble(title2002, score2002)
tib2001 <- tibble(title2001, score2001)
tib2000 <- tibble(title2000, score2000)
tib1999 <- tibble(title1999, score1999)
tib1998 <- tibble(title1998, score1998)

#Will need to make year into variable for each
#should be able to do with separate funtion, put "(" as the separator

Popular_movies <- tib2018 %>%
  full_join(tib2017)%>%
  etc 
#tidy it, variables should be year, score, and title 

Popular_movies %>%
  group_by(year) %>%
  summarize(
    score = score,
    title = title,
    averagescore = mean(score)
  ) %>%
  ungroup() %>%
  ggplot(aes(x = year)) +
  geom_point(aes(y = score, label = title)) +
  geom_line(aes(y = averagescore)) +
  geom_text(data=subset(Popular_movies, score > 99 ), 
              check_overlap = TRUE, size = 2.5, nudge_y = 1)

```
